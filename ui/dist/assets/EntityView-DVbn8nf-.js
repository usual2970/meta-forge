import{l as B,b as N,u as O,c as g,r as b,n as V,p as j,a as q,d as l,o as E,e as F,g as u,t as y,f as r,w as i,q as h,s as S,F as P,h as p,P as T,v as $}from"./index-G6iigneH.js";import{S as A}from"./SettingOutlined-C07MBp2x.js";const D=_=>B({url:"/api/v1/data/list",method:"get",params:_}),I={class:"flex justify-between"},K={class:"text-2xl text-slate-700"},L={class:"flex"},M={class:"flex justify-between mt-2"},H={__name:"EntityView",setup(_){const x=N(),s=O(),f=g(()=>$(s.currentRoute.value.params.name)),v=b([]),d=async e=>{const a={table:e,page:n.current,pageSize:n.pageSize};let t=c.value;if(t&&t.order){let m=t.order==="ascend"?"asc":"desc";a.orderBy=`${t.field} ${m}`}const o=await D(a);o.code===0&&(v.value=o.data.data,n.total=o.data.totalRecords)};V(async()=>{console.log(s),await d(s.currentRoute.value.params.name)}),j((e,a)=>{e.params.name!==a.params.name&&(c.value=null,d(e.params.name))});const c=b(),R=g(()=>{const e=c.value||{};return x.getSchemaColumns(s.currentRoute.value.params.name).map(a=>(a.key===e.columnKey&&e.order?a.sortOrder=e.order:a.sortOrder=null,a))}),n=q({total:0,current:1,pageSize:20}),w=(e,a,t)=>{n.current=e.current,n.pageSize=e.pageSize,c.value=t,d(s.currentRoute.value.params.name)},C=()=>{},z=()=>{s.push({name:"entity-setting",params:{name:s.currentRoute.value.params.name,type:"crud"}})};return(e,a)=>{const t=l("a-button"),o=l("a-breadcrumb-item"),m=l("a-breadcrumb"),k=l("a-table");return E(),F(P,null,[u("div",I,[u("div",K,y(f.value),1),u("div",L,[r(t,{type:"primary",onClick:C,icon:h(S(T))},{default:i(()=>[p("新增")]),_:1},8,["icon"]),r(t,{type:"default",onClick:z,class:"ml-5",icon:h(S(A))},{default:i(()=>[p("设置")]),_:1},8,["icon"])])]),u("div",M,[r(m,{class:""},{default:i(()=>[r(o,null,{default:i(()=>[p(y(f.value),1)]),_:1})]),_:1})]),r(k,{dataSource:v.value,columns:R.value,class:"my-5",size:"middle",scroll:{x:1500,y:800},pagination:n,onChange:w},null,8,["dataSource","columns","pagination"])],64)}}};export{H as default};
